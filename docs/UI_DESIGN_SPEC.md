# ShiroPro Tools (Reborn) - UI設計仕様書

**Version**: 1.0  
**Last Updated**: 2025-12-07  
**Base Mockup**: v5

---

## 1. 全体レイアウト

```
┌────────────────────────────────────────────────────────┐
│ [≡] │  Header: タイトル / サマリー / Clear / Import   │
├─────┼──────────────────────────────────────────────────┤
│     │  ┌──┬──┬──┬──┬──┬──┬──┬──┐                      │
│ サ  │  │  │  │  │  │  │  │  │  │  編成スロット×8     │
│ イ  │  └──┴──┴──┴──┴──┴──┴──┴──┘                      │
│ ド  ├──────────────────────────────────────────────────┤
│ バ  │                                                  │
│ ｜  │         Buff Matrix（メインエリア）              │
│     │                                                  │
└─────┴──────────────────────────────────────────────────┘
```

- **PC専用**（モバイル対応は優先度低）
- **SPA構成**（React Router使用予定）
- **ダークテーマ**（gray-900ベース）

---

## 2. カラーパレット

### 属性カラー

| 属性 | 名前 | メインカラー | ライト | テキスト |
|------|------|-------------|--------|----------|
| plain | 平 | `bg-green-600` | `bg-green-500/20` | `text-green-400` |
| plain_mountain | 平山 | `bg-lime-500` | `bg-lime-500/20` | `text-lime-400` |
| mountain | 山 | `bg-amber-700` | `bg-amber-700/20` | `text-amber-500` |
| water | 水 | `bg-blue-600` | `bg-blue-500/20` | `text-blue-400` |
| hell | 地獄 | `bg-purple-600` | `bg-purple-500/20` | `text-purple-400` |
| none | 無 | `bg-gray-600` | `bg-gray-500/20` | `text-gray-400` |

### バフソースカラー

| ソース | カラー | 用途 |
|--------|--------|------|
| 自前 | `bg-blue-500` | 自身のスキルによるバフ |
| 味方 | `bg-green-500` | 他キャラからのバフ |
| 計略 | `bg-purple-500` | 計略によるバフ（将来実装） |

### ベースカラー

- 背景: `bg-gray-900`
- カード背景: `bg-gray-800`
- ボーダー: `border-gray-800` / `border-gray-700`
- テキスト: `text-white` / `text-gray-300` / `text-gray-400` / `text-gray-500`

---

## 3. コンポーネント仕様

### 3.1 左サイドバー（CharacterLibrary）

**折りたたみ対応**
- 展開時: `w-52` (208px)
- 折りたたみ時: `w-14` (56px)
- トグルボタン: `◀` / `▶`

**構成**
```
┌─────────────────┐
│ [トグル] タイトル │
├─────────────────┤
│ [検索ボックス]    │  ← 展開時のみ
├─────────────────┤
│ 平               │  ← 属性グループヘッダー
│  ・大坂城        │
│  ・姫路城        │
│  ・江戸城        │
│ 平山             │
│  ・犬山城        │
│ 山               │
│  ・安土城        │
│  ...             │
└─────────────────┘
```

**キャラカード（展開時）**
- 属性ドット（2x2px）+ 名前
- 編成済みは `opacity-30`

**キャラカード（折りたたみ時）**
- 属性ドットのみ（クリック可能）
- ツールチップで名前表示

---

### 3.2 編成スロット（FormationSlot）

**サイズ**: `aspect-square`（正方形）  
**グリッド**: `grid-cols-8 gap-3`

**状態**
| 状態 | スタイル |
|------|----------|
| 空 | `border-dashed border-gray-700` + `+`アイコン |
| 配置済み | 属性ライトカラー + 属性ボーダー |
| ホバー | 削除ボタン（✕）表示 |

**配置済みスロット内容**
```
┌─────────────┐
│    [✕]     │  ← ホバー時のみ表示
│    🏯      │  ← 画像（将来実装）
│   大坂城   │
│    歌舞    │
└─────────────┘
```

**操作**
- クリック（空）: なし
- クリック（配置済み）: 詳細モーダル表示
- ✕クリック: 編成から削除

---

### 3.3 バフマトリックス（BuffMatrix）

**メイン機能** - 最も重要なUI

**レイアウト**
```
┌────────────────────────────────────────────────┐
│ 項目(w-28) │ 大坂城 │ 姫路城 │ 安土城 │ ...   │
├────────────────────────────────────────────────┤
│ ▼ 気・計略                                     │
│   気        │ [bar] │ [bar] │ [bar] │        │
│             │ +8%   │  —    │  —    │        │
│   計略短縮  │ [bar] │ [bar] │ [bar] │        │
│             │  —    │  —    │  —    │        │
├────────────────────────────────────────────────┤
│ ▼ 攻撃系                                       │
│   攻撃      │ [bar] │ [bar] │ [bar] │        │
│             │ +80%  │ +50%  │ +65%  │        │
│   ...                                          │
└────────────────────────────────────────────────┘
```

**カテゴリ（折りたたみ可能、デフォルト展開）**
1. 気・計略: 気, 計略短縮
2. 攻撃系: 攻撃, 与ダメ, 射程
3. 防御系: 防御, 被ダメ軽減
4. 速度系: 攻撃速度, 攻撃隙
5. その他: 回復, 対象数

**バフバー**
- 高さ: `h-2`
- 青（自前）→ 緑（味方）の順で表示
- 0%の場合は空バー

**数値表示**
- フォント: `text-sm font-medium`
- 値あり: `text-white` + `+XX%`
- 値なし: `text-gray-600` + `—`

---

### 3.4 キャラ詳細モーダル（CharacterModal）

**トリガー**
- 編成スロットのキャラをクリック
- バフマトリックスのキャラ名をクリック

**サイズ**: `max-w-lg max-h-[80vh]`

**構成**
```
┌────────────────────────────────┐
│ [画像] 大坂城                   │
│        平・歌舞・☆7・Cost 28  │
│                    📖 Wiki ↗  │  ← 右上
│                          [✕]  │
├────────────────────────────────┤
│ 現在の編成でのダメージ          │  ← 編成中のみ表示
│ ┌──────────┬──────────┐       │
│ │最終攻撃力 │推定ダメージ│       │
│ │   892    │   1160   │       │
│ │ +54%    │与ダメ+30% │       │
│ └──────────┴──────────┘       │
├────────────────────────────────┤
│ 基礎ステータス (Lv100)          │
│ HP 3800 │ ATK 580 │ DEF 420...│
├────────────────────────────────┤
│ Team Buffs                     │
│ [全体] 攻撃 +30%               │
│ [全体] 防御 +30%               │
├────────────────────────────────┤
│ 特技: 天下の名城                │
│ 全城娘の攻撃と防御が30%上昇     │
├────────────────────────────────┤
│ 計略: 黄金の茶室 (CT 60s)      │
│ 範囲内の城娘の攻撃が50%上昇...  │
└────────────────────────────────┘
```

---

### 3.5 ヘッダー

**構成**
```
┌──────────────────────────────────────────────────────┐
│ ShiroPro Tools                                       │
│ 御城プロジェクト:RE 統合計算ツール                      │
│                                                      │
│           近接 3  遠隔 5 │ 平 4  山 2  水 2 │ 6/8    │
│                                      [Clear] [Import]│
└──────────────────────────────────────────────────────┘
```

---

## 4. インタラクション

### キャラ追加フロー
1. 左サイドバーでキャラをクリック
2. 最初の空きスロットに自動配置
3. バフマトリックスが即時更新

### キャラ削除フロー
1. 編成スロットをホバー → ✕ボタン表示
2. ✕クリックで削除
3. バフマトリックスが即時更新

### 詳細表示フロー
1. 編成スロット or マトリックスのキャラ名をクリック
2. モーダル表示（オーバーレイ付き）
3. オーバーレイ or ✕クリックで閉じる

---

## 5. 将来実装予定

### Phase 1（現在）
- ✅ 基本レイアウト
- ✅ キャラ追加/削除
- ✅ バフマトリックス表示
- ✅ 簡易ダメージ計算

### Phase 2
- 🔲 Wikiインポート機能
- 🔲 キャラ画像表示
- 🔲 検索/フィルター機能

### Phase 3
- 🔲 詳細ダメージ計算（DAMAGE_CALCULATOR_SPEC準拠）
- 🔲 URL共有機能
- 🔲 LocalStorage保存

### Phase 4
- 🔲 マップ制約チェック
- 🔲 動的バフ表示
- 🔲 伏兵バフ対応

---

## 6. 技術スタック

- **Framework**: React 18+
- **Language**: TypeScript
- **Build**: Vite
- **Styling**: TailwindCSS v4
- **State**: React Context + useReducer（または Zustand）
- **Test**: Vitest

---

## 変更履歴

### v1.0 (2025-12-07)
- 初版作成
- v5モックアップベースで仕様確定
- カラーパレット、コンポーネント仕様を文書化

---

*Document Status: Approved*
